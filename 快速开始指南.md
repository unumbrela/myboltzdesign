# BoltzDesign å¿«é€Ÿå¼€å§‹æŒ‡å— ğŸš€

æ­å–œï¼å®‰è£…å·²ç»å®Œæˆã€‚ç°åœ¨è®©æˆ‘ä»¬å¼€å§‹ä½¿ç”¨ BoltzDesign è¿›è¡Œè›‹ç™½è´¨è®¾è®¡ã€‚

---

## ğŸ“‹ ç›®å½•
1. [ä½¿ç”¨æ–¹å¼é€‰æ‹©](#ä½¿ç”¨æ–¹å¼é€‰æ‹©)
2. [å¿«é€Ÿæµ‹è¯•è¿è¡Œ](#å¿«é€Ÿæµ‹è¯•è¿è¡Œ)
3. [ç¤ºä¾‹åœºæ™¯](#ç¤ºä¾‹åœºæ™¯)
4. [å‚æ•°è¯´æ˜](#å‚æ•°è¯´æ˜)
5. [æŸ¥çœ‹ç»“æœ](#æŸ¥çœ‹ç»“æœ)
6. [å¸¸è§é—®é¢˜](#å¸¸è§é—®é¢˜)

---

## ä½¿ç”¨æ–¹å¼é€‰æ‹©

BoltzDesign æä¾›ä¸¤ç§ä½¿ç”¨æ–¹å¼ï¼š

### æ–¹å¼ 1: å‘½ä»¤è¡Œè„šæœ¬ï¼ˆæ¨èç”¨äºæ‰¹é‡è¿è¡Œï¼‰
```bash
python boltzdesign.py [å‚æ•°]
```
- âœ… é€‚åˆæ‰¹é‡å¤„ç†
- âœ… é€‚åˆæœåŠ¡å™¨è¿è¡Œ
- âœ… å‚æ•°åŒ–é…ç½®
- âœ… æ˜“äºé›†æˆåˆ°æµç¨‹ä¸­

### æ–¹å¼ 2: Jupyter Notebookï¼ˆæ¨èç”¨äºäº¤äº’å¼æ¢ç´¢ï¼‰
```bash
jupyter notebook Boltzdesign1.ipynb
```
- âœ… å¯è§†åŒ–ç»“æœ
- âœ… äº¤äº’å¼è°ƒå‚
- âœ… é€‚åˆå­¦ä¹ å’Œæ¢ç´¢
- âœ… å®æ—¶æŸ¥çœ‹ç»“æ„

---

## å¿«é€Ÿæµ‹è¯•è¿è¡Œ

### æµ‹è¯• 1: å°åˆ†å­ç»“åˆè›‹ç™½è®¾è®¡ï¼ˆæœ€ç®€å•ï¼‰

è¿™æ˜¯æœ€å¿«çš„æµ‹è¯•ï¼Œç”¨äºéªŒè¯å®‰è£…æ˜¯å¦æ­£å¸¸å·¥ä½œï¼š

```bash
# æ¿€æ´»ç¯å¢ƒ
conda activate boltz_design

# è¿è¡Œå°åˆ†å­è®¾è®¡ï¼ˆ7v11 æ˜¯ä¸€ä¸ª PDB ä»£ç ï¼‰
python boltzdesign.py \
  --target_name 7v11 \
  --target_type small_molecule \
  --target_mols OQO \
  --gpu_id 0 \
  --design_samples 2 \
  --suffix test1 \
  --run_alphafold False
```

**å‚æ•°è¯´æ˜ï¼š**
- `--target_name 7v11`: PDB ä»£ç ï¼Œç³»ç»Ÿä¼šè‡ªåŠ¨ä¸‹è½½
- `--target_type small_molecule`: è®¾è®¡å°åˆ†å­ç»“åˆè›‹ç™½
- `--target_mols OQO`: ç›®æ ‡å°åˆ†å­çš„åç§°ï¼ˆåœ¨ PDB æ–‡ä»¶ä¸­çš„ IDï¼‰
- `--gpu_id 0`: ä½¿ç”¨ç¬¬ä¸€ä¸ª GPUï¼ˆå¦‚æœæ²¡æœ‰ GPUï¼Œå¯èƒ½ä¼šæŠ¥é”™ï¼‰
- `--design_samples 2`: ç”Ÿæˆ 2 ä¸ªè®¾è®¡æ–¹æ¡ˆ
- `--suffix test1`: è¾“å‡ºç›®å½•åç¼€
- `--run_alphafold False`: æš‚æ—¶ç¦ç”¨ AlphaFold3 éªŒè¯ï¼ˆéœ€è¦å•ç‹¬å®‰è£…ï¼‰

**é¢„æœŸè¿è¡Œæ—¶é—´ï¼š** çº¦ 15-30 åˆ†é’Ÿï¼ˆå–å†³äº GPUï¼‰

---

### æµ‹è¯• 2: DNA/RNA ç»“åˆè›‹ç™½è®¾è®¡

```bash
python boltzdesign.py \
  --target_name 5zmc \
  --target_type dna \
  --pdb_target_ids C,D \
  --gpu_id 0 \
  --design_samples 2 \
  --suffix dna_test \
  --run_alphafold False
```

**å‚æ•°è¯´æ˜ï¼š**
- `--target_type dna`: è®¾è®¡ DNA ç»“åˆè›‹ç™½
- `--pdb_target_ids C,D`: ç›®æ ‡é“¾ IDï¼ˆC å’Œ D é“¾æ˜¯ DNAï¼‰

---

### æµ‹è¯• 3: ä½¿ç”¨æœ¬åœ° PDB æ–‡ä»¶

å¦‚æœä½ æœ‰è‡ªå·±çš„ PDB æ–‡ä»¶ï¼š

```bash
python boltzdesign.py \
  --target_name my_protein \
  --pdb_path /path/to/your/protein.pdb \
  --target_type small_molecule \
  --target_mols SAM \
  --gpu_id 0 \
  --design_samples 2 \
  --suffix custom \
  --run_alphafold False
```

---

## ç¤ºä¾‹åœºæ™¯

### åœºæ™¯ 1: é‡‘å±ç»“åˆè›‹ç™½è®¾è®¡

```bash
python boltzdesign.py \
  --target_name 1a6m \
  --target_type metal \
  --target_mols ZN \
  --gpu_id 0 \
  --design_samples 5 \
  --suffix metal_binder \
  --run_alphafold False
```

### åœºæ™¯ 2: è›‹ç™½-è›‹ç™½ç›¸äº’ä½œç”¨è®¾è®¡

```bash
python boltzdesign.py \
  --target_name 1acb \
  --target_type protein \
  --pdb_target_ids B \
  --binder_id A \
  --gpu_id 0 \
  --design_samples 5 \
  --suffix ppi_design \
  --run_alphafold False
```

### åœºæ™¯ 3: å¢åŠ è®¾è®¡æ ·æœ¬å’Œè°ƒæ•´é•¿åº¦

```bash
python boltzdesign.py \
  --target_name 7v11 \
  --target_type small_molecule \
  --target_mols OQO \
  --gpu_id 0 \
  --design_samples 10 \
  --length_min 80 \
  --length_max 120 \
  --suffix custom_length \
  --run_alphafold False
```

---

## é‡è¦å‚æ•°è¯´æ˜

### å¿…éœ€å‚æ•°

| å‚æ•° | è¯´æ˜ | ç¤ºä¾‹ |
|------|------|------|
| `--target_name` | ç›®æ ‡åç§°/PDB ä»£ç  | `7v11` |
| `--target_type` | ç›®æ ‡ç±»å‹ | `small_molecule`, `dna`, `rna`, `protein`, `metal` |
| `--gpu_id` | GPU è®¾å¤‡ ID | `0` |

### ç›®æ ‡å®šä¹‰å‚æ•°

| å‚æ•° | è¯´æ˜ | ç¤ºä¾‹ |
|------|------|------|
| `--pdb_path` | æœ¬åœ° PDB æ–‡ä»¶è·¯å¾„ | `/path/to/file.pdb` |
| `--pdb_target_ids` | PDB ä¸­çš„ç›®æ ‡é“¾ ID | `C,D` |
| `--target_mols` | å°åˆ†å­/é‡‘å± ID | `OQO`, `SAM`, `ZN` |
| `--binder_id` | ç»“åˆè›‹ç™½é“¾ IDï¼ˆé»˜è®¤ Aï¼‰ | `A` |

### è®¾è®¡å‚æ•°

| å‚æ•° | è¯´æ˜ | é»˜è®¤å€¼ |
|------|------|--------|
| `--design_samples` | ç”Ÿæˆè®¾è®¡æ•°é‡ | `1` |
| `--length_min` | æœ€å°é•¿åº¦ | `100` |
| `--length_max` | æœ€å¤§é•¿åº¦ | `150` |
| `--suffix` | è¾“å‡ºç›®å½•åç¼€ | `0` |

### ä¼˜åŒ–å‚æ•°ï¼ˆé«˜çº§ï¼‰

| å‚æ•° | è¯´æ˜ | é»˜è®¤å€¼ |
|------|------|--------|
| `--pre_iteration` | é¢„çƒ­è¿­ä»£æ¬¡æ•° | `30` |
| `--soft_iteration` | Softmax è¿­ä»£æ¬¡æ•° | `75` |
| `--temp_iteration` | æ¸©åº¦é€€ç«è¿­ä»£æ¬¡æ•° | `45` |
| `--hard_iteration` | ç¡¬ç¼–ç è¿­ä»£æ¬¡æ•° | `5` |
| `--num_inter_contacts` | é“¾é—´æ¥è§¦æ•° | `2` |
| `--num_intra_contacts` | é“¾å†…æ¥è§¦æ•° | `2` |

### AlphaFold3 éªŒè¯ï¼ˆéœ€è¦å•ç‹¬å®‰è£… AF3ï¼‰

| å‚æ•° | è¯´æ˜ | é»˜è®¤å€¼ |
|------|------|--------|
| `--run_alphafold` | æ˜¯å¦è¿è¡Œ AF3 éªŒè¯ | `True` |
| `--alphafold_dir` | AF3 å®‰è£…ç›®å½• | `~/alphafold3` |
| `--af3_docker_name` | AF3 Docker å®¹å™¨å | - |

---

## æŸ¥çœ‹ç»“æœ

### è¾“å‡ºç›®å½•ç»“æ„

è¿è¡Œåï¼Œç»“æœä¼šä¿å­˜åœ¨ä»¥ä¸‹ç›®å½•ï¼š

```
outputs/
â””â”€â”€ {target_type}_{target_name}_{suffix}/
    â”œâ”€â”€ results_final/              # æœ€ç»ˆè®¾è®¡ç»“æœ
    â”‚   â”œâ”€â”€ predictions/            # ç»“æ„é¢„æµ‹
    â”‚   â”œâ”€â”€ *.cif                   # ç»“æ„æ–‡ä»¶
    â”‚   â””â”€â”€ rmsd_results.csv        # ç»“æœç»Ÿè®¡
    â”œâ”€â”€ ligandmpnn_cutoff_4/        # LigandMPNN é‡è®¾è®¡ç»“æœ
    â”‚   â”œâ”€â”€ 01_lmpnn_redesigned/    # é‡è®¾è®¡çš„åºåˆ—
    â”‚   â””â”€â”€ 03_af_pdb_success/      # é«˜ç½®ä¿¡åº¦è®¾è®¡ï¼ˆå¦‚æœè¿è¡Œäº† AF3ï¼‰
    â””â”€â”€ pdb/                        # PDB æ ¼å¼æ–‡ä»¶
```

### æŸ¥çœ‹è®¾è®¡è´¨é‡æŒ‡æ ‡

```bash
# æŸ¥çœ‹è®¾è®¡ç»“æœç»Ÿè®¡
cat outputs/*/results_final/rmsd_results.csv
```

å…³é”®æŒ‡æ ‡ï¼š
- **iptm**: ç•Œé¢é¢„æµ‹ç½®ä¿¡åº¦ï¼ˆè¶Šé«˜è¶Šå¥½ï¼Œ>0.5 ä¸ºå¥½ï¼‰
- **complex_plddt**: å¤åˆç‰©æ•´ä½“ç½®ä¿¡åº¦ï¼ˆè¶Šé«˜è¶Šå¥½ï¼Œ>0.7 ä¸ºå¥½ï¼‰
- **apo_holo_rmsd**: ç»“æ„å˜åŒ–ï¼ˆè¶Šå°è¶Šå¥½ï¼‰

### å¯è§†åŒ–ç»“æ„

**ä½¿ç”¨ PyMOLï¼š**
```bash
pymol outputs/*/results_final/predictions/*/*.cif
```

**ä½¿ç”¨ Jupyter Notebookï¼š**
æ‰“å¼€ `Boltzdesign1.ipynb` å¯ä»¥è¿›è¡Œäº¤äº’å¼å¯è§†åŒ–ã€‚

---

## é«˜çº§ç”¨æ³•

### è°ƒæ•´è®¾è®¡å‚æ•°ä»¥æ”¹å–„ç»“æœ

å¦‚æœç”Ÿæˆçš„ç»“åˆè›‹ç™½ä¸å¤Ÿç´§å‡‘ï¼š
```bash
--num_intra_contacts 4  # ä»é»˜è®¤çš„ 2 å¢åŠ åˆ° 4
```

å¦‚æœç›®æ ‡æ²¡æœ‰ä¸ç»“åˆè›‹ç™½å½¢æˆè‰¯å¥½ç›¸äº’ä½œç”¨ï¼š
```bash
--num_inter_contacts 4  # ä»é»˜è®¤çš„ 2 å¢åŠ åˆ° 4
```

å¦‚æœæƒ³è¦æ›´å¤š Î²-æŠ˜å è€Œé Î±-èºæ—‹ï¼š
```bash
--helix_loss_max -0.3
--helix_loss_min -0.6
```

å¦‚æœéœ€è¦é€šè¿‡å¤šæ¬¡å¾ªç¯æ”¹å–„ç‰¹å¾ï¼š
```bash
--recycling_steps 1  # é»˜è®¤æ˜¯ 0
```

### ä½¿ç”¨é…ç½®æ–‡ä»¶

ä½ ä¹Ÿå¯ä»¥ä½¿ç”¨ YAML é…ç½®æ–‡ä»¶æ¥ç®¡ç†å¤æ‚çš„å‚æ•°ï¼š

```bash
# æŸ¥çœ‹ç¤ºä¾‹é…ç½®
ls inputs/yaml/

# ä½¿ç”¨é…ç½®æ–‡ä»¶è¿è¡Œ
# ï¼ˆéœ€è¦ä¿®æ”¹ boltzdesign.py ä»¥æ”¯æŒé…ç½®æ–‡ä»¶è¾“å…¥ï¼‰
```

---

## å¸¸è§é—®é¢˜

### Q1: å¦‚ä½•æ£€æŸ¥ GPU æ˜¯å¦å¯ç”¨ï¼Ÿ

```bash
python -c "import torch; print('CUDA available:', torch.cuda.is_available())"
```

### Q2: è¿è¡Œæ—¶å†…å­˜ä¸è¶³æ€ä¹ˆåŠï¼Ÿ

- å‡å°‘ `--design_samples` æ•°é‡
- å‡å°‘ `--length_max` é•¿åº¦
- ä½¿ç”¨æ›´å¤§æ˜¾å­˜çš„ GPU

### Q3: å¦‚ä½•å¹¶è¡Œè¿è¡Œå¤šä¸ªè®¾è®¡ï¼Ÿ

```bash
# è¿è¡Œå¤šä¸ªä¸åŒçš„è®¾è®¡ä»»åŠ¡
python boltzdesign.py --target_name 7v11 --suffix run1 --gpu_id 0 &
python boltzdesign.py --target_name 5zmc --suffix run2 --gpu_id 1 &
```

### Q4: ç»“æœçš„ç½®ä¿¡åº¦æŒ‡æ ‡æ„å‘³ç€ä»€ä¹ˆï¼Ÿ

- **iptm > 0.5**: ç•Œé¢é¢„æµ‹å¯é 
- **complex_plddt > 0.7**: æ•´ä½“ç»“æ„å¯é 
- **apo_holo_rmsd < 2.0**: ç»“æ„ç¨³å®šæ€§å¥½

### Q5: éœ€è¦å®‰è£… AlphaFold3 å—ï¼Ÿ

ä¸æ˜¯å¿…éœ€çš„ã€‚å¦‚æœä½ åªæƒ³ä½¿ç”¨ BoltzDesign è¿›è¡Œåˆæ­¥è®¾è®¡ï¼Œå¯ä»¥è®¾ç½®ï¼š
```bash
--run_alphafold False
```

å¦‚æœéœ€è¦ AF3 éªŒè¯ï¼Œéœ€è¦å•ç‹¬å®‰è£… AlphaFold3ï¼š
https://github.com/google-deepmind/alphafold3

---

## æ¨èå·¥ä½œæµç¨‹

### åˆå­¦è€…å·¥ä½œæµç¨‹

1. **ä»ç®€å•ç¤ºä¾‹å¼€å§‹**
   ```bash
   python boltzdesign.py --target_name 7v11 --target_type small_molecule \
     --target_mols OQO --gpu_id 0 --design_samples 2 --suffix test \
     --run_alphafold False
   ```

2. **æ£€æŸ¥ç»“æœè´¨é‡**
   ```bash
   cat outputs/*/results_final/rmsd_results.csv
   ```

3. **å¯è§†åŒ–æœ€ä½³è®¾è®¡**
   ```bash
   pymol outputs/*/results_final/predictions/*/*.cif
   ```

4. **è°ƒæ•´å‚æ•°é‡æ–°è¿è¡Œ**
   - å¦‚æœç»“æœä¸ç†æƒ³ï¼Œå‚è€ƒ"é«˜çº§ç”¨æ³•"éƒ¨åˆ†è°ƒæ•´å‚æ•°

### è¿›é˜¶ç”¨æˆ·å·¥ä½œæµç¨‹

1. **å‡†å¤‡è¾“å…¥** â†’ è‡ªå®šä¹‰ PDB æˆ–åºåˆ—
2. **è°ƒæ•´é…ç½®** â†’ ä¿®æ”¹è®¾è®¡ç®—æ³•å‚æ•°
3. **æ‰¹é‡è¿è¡Œ** â†’ ç”Ÿæˆå¤šä¸ªè®¾è®¡å˜ä½“
4. **åºåˆ—é‡è®¾è®¡** â†’ ä½¿ç”¨ LigandMPNN ä¼˜åŒ–åºåˆ—
5. **ç»“æ„éªŒè¯** â†’ ä½¿ç”¨ AlphaFold3 äº¤å‰éªŒè¯
6. **å®éªŒéªŒè¯** â†’ é€‰æ‹©é«˜ç½®ä¿¡åº¦è®¾è®¡è¿›è¡Œå®éªŒ

---

## è·å–å¸®åŠ©

### æŸ¥çœ‹æ‰€æœ‰å¯ç”¨å‚æ•°

```bash
python boltzdesign.py --help
```

### å‚è€ƒæ–‡æ¡£

- **è®ºæ–‡**: https://www.biorxiv.org/content/10.1101/2025.04.06.647261v1
- **Colab æ•™ç¨‹**: https://colab.research.google.com/github/yehlincho/BoltzDesign1/blob/main/Boltzdesign1.ipynb
- **GitHub ä»“åº“**: https://github.com/yehlincho/BoltzDesign1

### è”ç³»æ–¹å¼

æœ‰é—®é¢˜æˆ–å»ºè®®ï¼Ÿè”ç³»ä½œè€…ï¼šyehlin@mit.edu

---

## ä¸‹ä¸€æ­¥è¡ŒåŠ¨å»ºè®®

1. âœ… **è¿è¡Œç¬¬ä¸€ä¸ªæµ‹è¯•** - ä½¿ç”¨å°åˆ†å­è®¾è®¡ç¤ºä¾‹
2. âœ… **æŸ¥çœ‹è¾“å‡ºç»“æœ** - ç†è§£è¾“å‡ºæ–‡ä»¶ç»“æ„
3. âœ… **å°è¯•å¯è§†åŒ–** - ä½¿ç”¨ PyMOL æˆ– Jupyter æŸ¥çœ‹ç»“æ„
4. âœ… **é˜…è¯»è®ºæ–‡** - æ·±å…¥ç†è§£æ–¹æ³•åŸç†
5. âœ… **å¼€å§‹ä½ çš„é¡¹ç›®** - åº”ç”¨åˆ°å®é™…ç ”ç©¶é—®é¢˜

ç¥ä½ ä½¿ç”¨æ„‰å¿«ï¼ğŸ‰
